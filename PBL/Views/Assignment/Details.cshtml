@model AssignmentViewModel

<center>
    <h1>@Model.AssignmentName</h1>
    <p>
        <strong>
            Project:
        </strong> 
            @Model.ProjectName
    </p>
    @if (Model.AssignmentGrade != 0)
    {
        <p><strong>Grade:</strong>@Model.AssignmentGrade</p>
    }
    else
    {
        <p><strong>Grade: </strong> Not graded yet.</p>
    }

</center>

<p><strong>End Date: @Model.AssignmentDueDate.ToShortDateString()</strong></p>


<h2>Files</h2>
@if (Model.Files != null && Model.Files.Any())
{
    <ul>
        @foreach (var file in Model.Files)
        {
            <li>
                <a href="@Url.Action("Download", "File", new { id = file.FileId })">@file.FileName</a>
                <button onclick="confirmDelete(@file.FileId)">Delete</button>
                <form id="delete-form-@file.FileId" method="post" action="@Url.Action("Delete", "File", new { fileId = file.FileId })">
                    <input type="hidden" name="projectId" value="@Model.ProjectId" />
                    <input type="hidden" name="returnUrl" value="@Url.Action("Details", "Project", new { id = Model.ProjectId })" />
                </form>
            </li>
        }
    </ul>
}
else
{
    <p>No files found.</p>
}
<script>
    function confirmDelete(id) {
        if (confirm("Are you sure you want to delete this file?")) {
            document.getElementById("delete-form-" + id).submit();
        }
    }
</script>

<a asp-action="Upload" asp-controller="File" asp-route-assignmentId="@Model.AssignmentId">Upload File</a>
<hr/>
<h2>
    <strong>Project Description: <br /><br /></strong>
</h2>


<p>@Model.AssignmentDescription</p>
<br/>
<h2>Comments:</h2>
@if (Model?.Comments != null && Model.Comments.Count > 0)

{
    
    
    <hr />
    @foreach (var comment in Model.Comments)
    {

        <div class="table">
            <div class="d-table-cell col-12">
                <strong style="color:black">@comment.CreatedBy</strong> <p style="margin-left:2px;color:darkgrey" class="d-inline"><font size="1"> @comment.CreatedAt</font></p>
                <p style="margin-top:2px;color:black">@comment.CommentText</p>
            </div>
            <div class="d-table-cell">
                <form asp-controller="Comment" asp-action="DeleteComment" method="post" style="display:inline-table" class="delete-btn">
                    <input type="hidden" name="commentId" value="@comment.CommentId" />
                    <input type="hidden" name="view" value="AssignmentDetails" />
                    <button type="submit" class="btn btn-danger text-black">Delete</button>
                </form>
            </div>
        </div>
    }

}
else
{
    <p>
        No comments
    </p>
}

<form asp-controller="Comment" asp-action="AddComment" method="post">
    <input type="hidden" name="assignmentId" value="@Model?.AssignmentId" />
    

    <div class="form-group col-4">
        <label for="text">Add a comment:</label>
        <textarea class="form-control bg-white col-4" style="color:black" id="text" name="text"></textarea>
    </div>

    <button type="submit" class="btn btn-outline-primary">Add Comment</button>
</form>

@if (User.IsInRole("Teacher"))
{
    @* Add any additional properties you want to display here *@
    <div style="padding-top:15px">
        <h4 class="mb-2">Grade Assignment</h4>
        <hr />
        <form asp-action="GradeAssignment" asp-route-assignmentId="@Model?.AssignmentId" method="post">
            <div class="form-group col-1">
                <label asp-for="AssignmentGrade" class="control-label col-6 bg-black"></label>
                <input asp-for="AssignmentGrade" class="form-control col-6 bg-black" style="color:white;background-color:black" value=""/>
                <span asp-validation-for="AssignmentGrade" class="text-danger col-6"></span>
            </div>
            <div class="form-group">
                <input type="submit" value="Grade" class="btn btn-dark col-1" />
            </div>
        </form>
    </div>
}
<div class="mt-auto p-2 bd-highlight">
    <a class="btn btn-secondary col-12" asp-controller="Project" asp-action="Details" asp-route-id="@Model?.ProjectId">Back to project</a>
</div>